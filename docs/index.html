<!DOCTYPE html>
<html>
<head>
    <title>文档列表</title>
    <!-- 引入 Markdown 解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- 可选：引入 Bootstrap 样式 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        #content { padding: 20px; border: 1px solid #ddd; margin-top: 20px; }
    </style>
</head>
<body class="container-fluid mt-4">
    <div class="row">
        <!-- 侧边栏 -->
        <div class="col-md-4 col-lg-3">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h1 class="d-none d-md-block">文档列表</h1>
                <button class="btn btn-primary d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar">
                    ≡ 菜单
                </button>
            </div>
            <div class="collapse show" id="sidebar">
                <div id="file-list" class="mb-3"></div>
            </div>
        </div>

        <!-- 内容区域 -->
        <div class="col-md-8 col-lg-9">
            <div id="content" class="p-3"></div>
        </div>
    </div>

    <style>
        #content { 
            min-height: 80vh;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        @media (max-width: 768px) {
            #sidebar {
                background: #f8f9fa;
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 15px;
            }
            .col-md-8 {
                padding-top: 15px;
            }
        }
    </style>

    <script>
        // 在loadFileList函数最后添加：
        function handleWindowResize() {
            const sidebar = document.getElementById('sidebar');
            if (window.innerWidth >= 768) { // PC端
                sidebar.classList.add('show');
            } else { // 移动端
                sidebar.classList.remove('show');
            }
        }

        // 初始化时添加resize监听
        window.addEventListener('resize', handleWindowResize);
        handleWindowResize();


        // 配置参数（需替换为你的仓库信息）
        const REPO_OWNER = 'Turtur';
        const REPO_NAME = 'findata';
        const BRANCH = 'master'; // 默认分支名

        // 获取文件列表
        async function loadFileList() {
            const treeUrl = `https://github.com/${REPO_OWNER}/${REPO_NAME}/tree/${BRANCH}/day`;
            
            try {
                const response = await fetch(treeUrl);
                const html = await response.text();
                
                // 从GitHub页面解析.md文件名
                const mdFiles = [...html.matchAll(/href="\/Turtur\/findata\/blob\/master\/day\/([^"]+\.md)"/g)]
                    .map(m => m[1])
                    .filter(name => name.endsWith('.md'))
                    .sort((a, b) => b.localeCompare(a));

                // 生成列表
                const listHtml = mdFiles.map(fileName => `
                    <div class="mb-2">
                        <a href="#" class="file-link" data-url="${file.download_url}">
                            ${fileName.replace('.md', '')}
                        </a>
                    </div>
                `).join('');

                document.getElementById('file-list').innerHTML = listHtml;
                
                // 绑定点击事件
                document.querySelectorAll('.file-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const rawUrl = `https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/${BRANCH}/day/${encodeURIComponent(link.textContent.trim())}.md`;
                        loadMarkdownContent(rawUrl);
                    });
                });
            } catch (error) {
                console.error('加载文件列表失败:', error);
            }
        }

        // 加载并渲染 Markdown 内容
        async function loadMarkdownContent(url) {
            try {
                const response = await fetch(url);
                const markdown = await response.text();
                document.getElementById('content').innerHTML = marked.parse(markdown);
            } catch (error) {
                console.error('加载内容失败:', error);
            }
        }

        // 初始化加载列表
        loadFileList();
    </script>
</body>
</html>